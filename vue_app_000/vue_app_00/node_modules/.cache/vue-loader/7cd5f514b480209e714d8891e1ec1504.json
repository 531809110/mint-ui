{"remainingRequest":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\src\\components\\xz\\Cart.vue?vue&type=style&index=0&id=1a6f731a&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\src\\components\\xz\\Cart.vue","mtime":1567249395947},{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907988000},{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"C:\\Users\\web\\Desktop\\vue_app\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.cartItem {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.leftText {\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n\n.imgstyle {\n  width: 30px;\n  height: 30px;\n}\n",{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4IA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src\\components\\xz","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"selectAll\" @change=\"select\">全选<input v-model=\"status\" type=\"checkbox\"></div>\r\n    <div class=\"cartItem\" v-for=\"(item,index) in list\" :key=\"index\">\r\n      <div class=\"leftText\">\r\n        <input type=\"checkbox\" v-model=\"item.cb\" @change=\"seletItem\">\r\n        <div><img class=\"imgstyle\" :src=\"'http://127.0.0.1:8080/'+item.img_url\" alt=\"\"></div>\r\n        <div class=\"\"><span>{{item.id}}</span></div>\r\n        <div class=\"\"><span>{{item.lname}}</span></div>\r\n        <div class=\"\"><span>{{item.price}}</span></div>\r\n        <div class=\"\"><span>{{item.count}}</span></div>\r\n      </div>\r\n      <mt-button @click=\"del\" :data-id=\"item.id\">删除</mt-button>\r\n    </div>\r\n    <div @click=\"delAll\">\r\n      <mt-button>删除选中商品</mt-button>\r\n      <h3 style=\"color:red\">购物车数量：{{$store.getters.getCartCount}}</h3>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        list: [], //当前登录用户购物车列表\r\n        status: true\r\n      }\r\n    },\r\n    created() {\r\n      //当前组件创建成功回调函数\r\n      this.loadMore();\r\n    },\r\n    methods: {\r\n      seletItem() {\r\n        var b = true;\r\n        for (var item of this.list) {\r\n          b = b && item.cb;\r\n        }\r\n        if (b) {\r\n          this.status = true\r\n        } else {\r\n          this.status = false\r\n        }\r\n      },\r\n      delAll() {\r\n        var url = \"delAll\";\r\n        var ids = [];\r\n        for (var item of this.list) {\r\n          if (item.cb) {\r\n            ids.push(item.id);\r\n          }\r\n        }\r\n        if(ids.length==0){this.$toast(\"请选中商品\");return;}\r\n        ids = ids.join();\r\n        var obj = {\r\n          ids: ids\r\n        };\r\n        this.$messagebox.confirm(\"是否删除\").then(\r\n          action => {\r\n            if (action == \"confirm\") {\r\n              this.axios.get(url, {\r\n                params: obj\r\n              }).then(res => {\r\n                if (res.data.code == -2) {\r\n                  //4:如果服务器返回-2 删除失败\r\n                  this.$messagebox(\"\", \"删除失败\");\r\n                } else if (res.data.code == 1) {\r\n                  this.loadMore();\r\n                }\r\n              })\r\n            }\r\n          }\r\n        ).catch(err => {\r\n          return;\r\n        })\r\n      },\r\n      del(e) {\r\n        var url = \"delItem\";\r\n        var obj = {\r\n          id: e.target.dataset.id\r\n        };\r\n        this.$messagebox.confirm(\"是否删除\").then(\r\n          action => {\r\n            if (action == \"confirm\") {\r\n              this.axios.get(url, {\r\n                params: obj\r\n              }).then(res => {\r\n                if (res.data.code == -2) {\r\n                  //4:如果服务器返回-2 删除失败\r\n                  this.$messagebox(\"\", \"删除失败\");\r\n                } else if (res.data.code == 1) {\r\n                  this.loadMore();\r\n                }\r\n              })\r\n            }\r\n          }\r\n        ).catch(err => {\r\n          return;\r\n        })\r\n\r\n      },\r\n      select(e) {\r\n        var cb = e.target.checked; //e是事件对象，后面加一个属性target(target就是复选框)，复选框里有个属性checked\r\n        // console.log(cb)\r\n        for (var key of this.list) {\r\n          key.cb = cb;\r\n          // console.log(this.list);\r\n        }\r\n      },\r\n      loadMore() {\r\n        this.$store.commit(\"clear\");\r\n        //功能:获取当前用户购物车列表\r\n        //1:创建url请求服务器地址\r\n        var url = \"carts\";\r\n        //2:发送ajax 请求(让服务器程序完成功能)\r\n        this.axios.get(url).then(res => {\r\n          if (res.data.code == -1) {\r\n            //4:如果服务器返回-1 请登录\r\n            this.$messagebox(\"消息\", \"请登录\").then(res => {\r\n              //回调函数（用户点击确认按钮后调用函数）\r\n              this.$router.push(\"/Login\")\r\n            })\r\n          } else {\r\n            //3:获取服务器返回数据\r\n            var rows = res.data.data;\r\n            for (var key of rows) {\r\n              key.cb = true;\r\n              this.$store.commit(\"increment\");\r\n            }\r\n          //  this.$store.commit(\"updateCount(rows.length)\") \r\n            //  console.log(this.list)\r\n            this.list = rows;\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .cartItem {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n\r\n  .leftText {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-around;\r\n  }\r\n\r\n  .imgstyle {\r\n    width: 30px;\r\n    height: 30px;\r\n  }\r\n</style>"]}]}